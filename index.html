<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#000212">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>MangaMap · 灵动导航</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/svg+xml" href="blackcat.svg">  
  <link rel="apple-touch-icon" href="image/logo.png">  
  <link rel="manifest" href="manifest.json">
</head>
<body>
  <div class="background-glow">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>

  <div id="authScreen" class="auth-screen">
    <div class="auth-card glass">
      <div class="auth-header">
        <div class="dot red"></div>
        <div class="dot yellow"></div>
        <div class="dot green"></div>
      </div>
      <div class="auth-body">
        <h1>MangaMap</h1>
        <p>Face ID 已锁定 / 输入口令</p>
        <form id="loginForm" class="auth-form">
          <label class="field">
            <input id="passwordInput" type="password" placeholder="输入访问口令" autocomplete="current-password" required>
            <div class="input-glow"></div>
          </label>
          <p id="authError" class="auth-error" role="alert"></p>
          <button type="submit" class="btn primary full">解锁</button>
        </form>
      </div>
    </div>
  </div>

  <header class="page-header">
      
    <div class="profile-section">
      <div class="avatar-box">
        <img src="blackcat.svg" alt="头像" loading="lazy">
      </div>
      <div class="info-box">
        <h1>MangaMap</h1>
        <div class="badge">
          <span>Designed by</span>
          <span class="highlight"><a href="https://jisuk.top/" target="_blank" rel="noopener noreferrer">不鹤</a></span>
        </div>
      </div>
    </div>
    <div class="action-section">
        <button id="themeBtn" class="circle-btn glass" title="切换主题" aria-label="切换主题">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
          </svg>
        </button>
        
        <button id="addBtn" class="circle-btn glass" title="新增" aria-label="新增站点">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        </button>
        
        <button id="logoutBtn" class="circle-btn glass" title="锁定" aria-label="锁定">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
        </button>
    </div>
  </header>

  <nav class="category-nav" id="categoryNav">
    <button class="nav-chip active" data-category="漫画">漫画</button>
    <button class="nav-chip" data-category="动漫">动漫</button>
    <button class="nav-chip" data-category="小说">小说</button>
    <button class="nav-chip" data-category="工具">工具</button>
  </nav>

  <main class="main">
    <div id="linkGrid" class="link-grid"></div>
  </main>

  <div id="modal" class="modal hidden" aria-hidden="true">
    <div class="modal-card glass">
      <div class="modal-head">
        <div>
          <p class="eyebrow" id="modalEyebrow">配置</p>
          <h3 id="modalTitle">站点信息</h3>
        </div>
        <button class="icon-btn close-btn" id="closeModalBtn" aria-label="关闭">✕</button>
      </div>
      <form id="linkForm" class="modal-body">
        <input type="hidden" id="editingId">
        
        <label class="field">
          <span>网址</span>
          <input id="urlInput" type="url" placeholder="https://" required>
        </label>

        <label class="field">
          <span>名称</span>
          <input id="nameInput" type="text" placeholder="站点名称" autocomplete="off" required>
          </label>
        
        <label class="field">
          <span>分类</span>
          <select id="categoryInput" required>
            <option value="漫画">漫画</option>
            <option value="动漫">动漫</option>
            <option value="小说">小说</option>
            <option value="工具">工具</option>
          </select>
        </label>
        
        <div class="field">
          <span>图标</span>
          <div class="icon-preview-row">
            <div class="favicon preview">
              <img id="iconPreview" alt="图标预览">
            </div>
            <div class="upload-actions">
              <label class="btn ghost small">
                <input id="iconFileInput" type="file" accept="image/*" hidden>
                上传图片
              </label>
              <input id="iconUrlInput" class="small-input" type="url" placeholder="或输入图片 URL">
            </div>
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="button" class="btn ghost" id="cancelBtn">取消</button>
          <button type="submit" class="btn primary" id="submitBtn">保存更改</button>
        </div>
      </form>
    </div>
  </div>

<template id="linkCardTemplate">
    <article class="card glass">
      <div class="card-actions">
        <button class="icon-btn edit" title="编辑">
           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
        </button>
        <button class="icon-btn danger delete" title="删除">
           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
        </button>
      </div>
      <div class="status-indicator"></div>      
      <a class="card-body" target="_blank" rel="noopener noreferrer">
        <div class="favicon">
          <img alt="Icon" loading="lazy" decoding="async">
        </div>
        <div class="card-text">
          <h4></h4>
          <p></p>
        </div>
      </a>
    </article>
  </template>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
  <script src="script.js"></script>
</body>
</html>